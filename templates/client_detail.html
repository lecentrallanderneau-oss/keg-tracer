{% extends "base.html" %}
{% block title %}Client — Keg Tracer{% endblock %}
{% block content %}
<h1>{{ client.name }}</h1>
<p class="muted">
  ID {{ client.id }} · <a href="/admin/add-transaction">+ Ajouter un mouvement</a>
</p>

<h2>Stock attendu (net)</h2>
<table>
  <thead><tr><th>Produit</th><th>L</th><th>Qté</th><th>Consigne (€)</th></tr></thead>
  <tbody>
  {% for r in balance.by_sku|default([], true) %}
    <tr>
      <td>{{ r.product }}</td>
      <td>{{ r.size_l }}</td>
      <td>{{ r.qty }}</td>
      <td>{{ (r.deposit_eur|default(0)|float)|round(2) }}</td>
    </tr>
  {% else %}
    <tr><td colspan="4" class="muted">Aucun mouvement.</td></tr>
  {% endfor %}
  </tbody>
  <tfoot>
    <tr>
      <th colspan="2">Total</th>
      <th>{{ balance.total_kegs|default(0) }}</th>
      <th>{{ (balance.total_deposit_eur|default(0)|float)|round(2) }}</th>
    </tr>
  </tfoot>
</table>

<h2>Historique des mouvements</h2>
<table>
  <thead><tr><th>Date</th><th>Type</th><th>Produit</th><th>L</th><th>Qté</th><th>Consigne (€)</th><th>Doc</th></tr></thead>
  <tbody>
  {% for t in transactions|default([], true) %}
    <tr>
      <td>{{ t.date }}</td>
      <td>{{ t.type }}</td>
      <td>{{ t.product }}</td>
      <td>{{ t.size_l }}</td>
      <td>{{ t.qty }}</td>
      <td>{{ (t.deposit_eur|default(0)|float)|round(2) }}</td>
      <td>{{ t.doc_no }}</td>
    </tr>
  {% else %}
    <tr><td colspan="7" class="muted">Aucun mouvement.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
