{% extends "base.html" %}
{% block title %}Mouvements · Suivi des Fûts{% endblock %}
{% block content %}

<h2>Mouvements récents</h2>
<p><a href="{{ url_for('movement_add') }}">+ Ajouter un mouvement</a></p>

<div class="table-responsive">
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Client</th>
        <th>Bière</th>
        <th>Qté</th>
        <th>Consigne/fût</th>
        <th>Notes</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for m in moves %}
      <tr>
        <td>{{ m.dt.isoformat() if m.dt else '' }}</td>
        <td>
          {% if m.mtype=='delivery' %}Livraison
          {% elif m.mtype=='return_full' %}Retour plein
          {% elif m.mtype=='return_empty' %}Retour vide
          {% else %}{{ m.mtype }}{% endif %}
        </td>
        <td>{{ m.client.name if m.client else '' }}</td>
        <td>{{ m.beer.name if m.beer else '' }}</td>
        <td>{{ m.qty or 0 }}</td>
        <td>{{ ((m.consigne_per_keg or 0)|float)|round(2) }}</td>
        <td>{{ m.notes or '' }}</td>
        <td>
          <form method="post" action="{{ url_for('movement_delete', mid=m.id) }}" onsubmit="return confirm('Supprimer ce mouvement ?');">
            <button type="submit">Supprimer</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="8">Aucun mouvement pour l’instant.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
