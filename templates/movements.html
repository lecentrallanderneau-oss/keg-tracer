{% extends "base.html" %}
{% block title %}Mouvements · Suivi des Fûts{% endblock %}
{% block content %}

<h2>Mouvements récents</h2>
<p><a href="{{ url_for('movement_add') }}">+ Ajouter un mouvement</a></p>

<div class="table-responsive">
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Client</th>
        <th>Bière</th>
        <th>Qté</th>
        <th>Consigne/fût</th>
        <th>Notes</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for m in moves %}
      <tr>
        <td>{{ m.dt }}</td>
        <td>{{ 'Livraison' if m.mtype=='delivery' else ('Retour plein' if m.mtype=='return_full' else 'Retour vide') }}</td>
        <td>{{ m.client.name }}</td>
        <td>{{ m.beer.name }}</td>
        <td>{{ m.qty }}</td>
        <td>{{ '%.2f'|format(m.consigne_per_keg) }}</td>
        <td>{{ m.notes or '' }}</td>
        <td>
          <form method="post" action="{{ url_for('movement_delete', mid=m.id) }}" onsubmit="return confirm('Supprimer ce mouvement ?');">
            <button type="submit">Supprimer</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="8">Aucun mouvement pour l’instant.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
